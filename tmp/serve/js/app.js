/// <reference path="../../typings/jquery/jquery.d.ts" />
'use strict';

var app = app || {};

(function () {
  'use strict';

  $(function () {
    var _this = this;

    var $todolist = $('.js-todolist');
    var $inputText = $('.js-text');
    var $inputDetail = $('.js-detail');
    var $numListed = $('.js-num-listed');
    var $numChecked = $('.js-num-checked');

    // 初期処理
    var todos = new app.common.Todos();
    todos.todoItems.forEach(function (item) {
      return appendList(item);
    });
    updateChecks();

    // addボタンクリック
    $('.js-add').click(function () {
      if ($inputText.val()) {

        var todoItem = new app.common.Todo(Date.now().toString(), $inputText.val(), $('.js-priority:checked').val(), $inputDetail.val());
        appendList(todoItem);
        todos.add(todoItem);

        $inputText.val('');
        $inputDetail.val('');
        updateChecks();
      } else {
        console.log('未入力です');
      }
    });

    // checkboxクリック
    $todolist.click(function (event) {
      var $check = $(event.target);
      if ($check.prop('checked')) {
        $check.parent().css('text-decoration', 'line-through');
      } else {
        $check.parent().css('text-decoration', 'none');
      }
      updateChecks();
    });

    // archiveボタンクリック
    $('.js-archive').click(function () {
      // remove対象のidを基にlocalStorageから削除
      var removeList = [];
      var $checked = $('.js-checkbox:checked');

      $checked.each(function (index, checkbox) {
        removeList.push($(_this).val());
      });
      todos.remove(removeList);

      // 画面から削除
      $checked.parents('.js-todoitem').remove();
      updateChecks();
    });

    function updateChecks() {
      $numListed.text($('.js-todolist > li').length);
      $numChecked.text($('.js-checkbox:not(:checked)').length);
    };

    function appendList(todoItem) {
      var priorityClass = toPriorityClass(todoItem.priority);
      $todolist.append('\n            <li class="js-todoitem ' + priorityClass + '">\n              <input id="todoitem-' + todoItem.id + '" type="checkbox" class="js-checkbox" value="' + todoItem.id + '">\n              <label for="todoitem-' + todoItem.id + '">\n                <a href="detail.html?id=' + todoItem.id + '" title="' + todoItem.detail + '">' + todoItem.title + '</a>\n              </label>\n            </li>\n          ');
    }

    function toPriorityClass(priority) {
      var priorityClass = undefined;
      switch (priority) {
        case '0':
          priorityClass = 'priority-high';
          break;
        case '1':
          priorityClass = 'priority-med';
          break;
        case '2':
          priorityClass = 'priority-low';
          break;
      }
      return priorityClass;
    }
  });
})();
//# sourceMappingURL=data:application/json;base64,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O0tBQ2hCLENBQUMsQ0FBQzs7QUFFSCxhQUFTLFlBQVksR0FBRztBQUN0QixnQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUMvQyxpQkFBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsNEJBQTRCLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUMxRCxDQUFDOztBQUVGLGFBQVMsVUFBVSxDQUFDLFFBQVEsRUFBRTtBQUM1QixVQUFJLGFBQWEsR0FBRyxlQUFlLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3ZELGVBQVMsQ0FBQyxNQUFNLDJDQUNhLGFBQWEsOENBQ2QsUUFBUSxDQUFDLEVBQUUscURBQWdELFFBQVEsQ0FBQyxFQUFFLCtDQUNyRSxRQUFRLENBQUMsRUFBRSxvREFDTixRQUFRLENBQUMsRUFBRSxpQkFBWSxRQUFRLENBQUMsTUFBTSxVQUFLLFFBQVEsQ0FBQyxLQUFLLGlFQUd2RixDQUFDO0tBRU47O0FBRUQsYUFBUyxlQUFlLENBQUMsUUFBUSxFQUFFO0FBQ2pDLFVBQUksYUFBYSxZQUFBLENBQUM7QUFDakIsY0FBUSxRQUFRO0FBQ2YsYUFBSyxHQUFHO0FBQ04sdUJBQWEsR0FBRyxlQUFlLENBQUM7QUFDaEMsZ0JBQU07QUFBQSxBQUNSLGFBQUssR0FBRztBQUNOLHVCQUFhLEdBQUcsY0FBYyxDQUFDO0FBQy9CLGdCQUFNO0FBQUEsQUFDUixhQUFLLEdBQUc7QUFDTix1QkFBYSxHQUFHLGNBQWMsQ0FBQztBQUMvQixnQkFBTTtBQUFBLE9BQ1Q7QUFDRCxhQUFPLGFBQWEsQ0FBQztLQUN0QjtHQUNKLENBQUMsQ0FBQztDQUNKLENBQUEsRUFBRyxDQUFDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL2pxdWVyeS9qcXVlcnkuZC50c1wiIC8+XHJcbnZhciBhcHAgPSBhcHAgfHwge307XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG4gIFxyXG4gICQoZnVuY3Rpb24oKSB7XHJcbiBcclxuICAgICAgY29uc3QgJHRvZG9saXN0ICAgICAgPSAkKCcuanMtdG9kb2xpc3QnKTtcclxuICAgICAgY29uc3QgJGlucHV0VGV4dCAgICAgPSAkKCcuanMtdGV4dCcpO1xyXG4gICAgICBjb25zdCAkaW5wdXREZXRhaWwgICA9ICQoJy5qcy1kZXRhaWwnKTtcclxuICAgICAgY29uc3QgJG51bUxpc3RlZCAgICAgPSAkKCcuanMtbnVtLWxpc3RlZCcpO1xyXG4gICAgICBjb25zdCAkbnVtQ2hlY2tlZCAgICA9ICQoJy5qcy1udW0tY2hlY2tlZCcpO1xyXG4gICAgICBcclxuICAgICAgLy8g5Yid5pyf5Yem55CGXHJcbiAgICAgIGxldCB0b2RvcyA9IG5ldyBhcHAuY29tbW9uLlRvZG9zO1xyXG4gICAgICB0b2Rvcy50b2RvSXRlbXMuZm9yRWFjaChpdGVtID0+IGFwcGVuZExpc3QoaXRlbSkpO1xyXG4gICAgICB1cGRhdGVDaGVja3MoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIGFkZOODnOOCv+ODs+OCr+ODquODg+OCr1xyXG4gICAgICAkKCcuanMtYWRkJykuY2xpY2soKCkgPT4ge1xyXG4gICAgICAgIGlmKCRpbnB1dFRleHQudmFsKCkpIHtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgbGV0IHRvZG9JdGVtID0gbmV3IGFwcC5jb21tb24uVG9kbyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGUubm93KCkudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbnB1dFRleHQudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuanMtcHJpb3JpdHk6Y2hlY2tlZCcpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGlucHV0RGV0YWlsLnZhbCgpKTtcclxuICAgICAgICAgIGFwcGVuZExpc3QodG9kb0l0ZW0pO1xyXG4gICAgICAgICAgdG9kb3MuYWRkKHRvZG9JdGVtKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgJGlucHV0VGV4dC52YWwoJycpO1xyXG4gICAgICAgICAgJGlucHV0RGV0YWlsLnZhbCgnJyk7XHJcbiAgICAgICAgICB1cGRhdGVDaGVja3MoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ+acquWFpeWKm+OBp+OBmScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBjaGVja2JveOOCr+ODquODg+OCr1xyXG4gICAgICAkdG9kb2xpc3QuY2xpY2soKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgJGNoZWNrID0gJChldmVudC50YXJnZXQpO1xyXG4gICAgICAgIGlmICgkY2hlY2sucHJvcCgnY2hlY2tlZCcpKSB7XHJcbiAgICAgICAgICAkY2hlY2sucGFyZW50KCkuY3NzKCd0ZXh0LWRlY29yYXRpb24nLCAnbGluZS10aHJvdWdoJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICRjaGVjay5wYXJlbnQoKS5jc3MoJ3RleHQtZGVjb3JhdGlvbicsICdub25lJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVwZGF0ZUNoZWNrcygpO1xyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIGFyY2hpdmXjg5zjgr/jg7Pjgq/jg6rjg4Pjgq9cclxuICAgICAgJCgnLmpzLWFyY2hpdmUnKS5jbGljaygoKSA9PiB7XHJcbiAgICAgICAgLy8gcmVtb3Zl5a++6LGh44GuaWTjgpLln7rjgatsb2NhbFN0b3JhZ2XjgYvjgonliYrpmaRcclxuICAgICAgICBsZXQgcmVtb3ZlTGlzdCA9IFtdO1xyXG4gICAgICAgIGNvbnN0ICRjaGVja2VkID0gJCgnLmpzLWNoZWNrYm94OmNoZWNrZWQnKTtcclxuICAgICAgICBcclxuICAgICAgICAkY2hlY2tlZC5lYWNoKChpbmRleCwgY2hlY2tib3gpID0+IHtcclxuICAgICAgICAgIHJlbW92ZUxpc3QucHVzaCgkKHRoaXMpLnZhbCgpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0b2Rvcy5yZW1vdmUocmVtb3ZlTGlzdCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g55S76Z2i44GL44KJ5YmK6ZmkXHJcbiAgICAgICAgJGNoZWNrZWQucGFyZW50cygnLmpzLXRvZG9pdGVtJykucmVtb3ZlKCk7XHJcbiAgICAgICAgdXBkYXRlQ2hlY2tzKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgZnVuY3Rpb24gdXBkYXRlQ2hlY2tzKCkge1xyXG4gICAgICAgICRudW1MaXN0ZWQudGV4dCgkKCcuanMtdG9kb2xpc3QgPiBsaScpLmxlbmd0aCk7XHJcbiAgICAgICAgJG51bUNoZWNrZWQudGV4dCgkKCcuanMtY2hlY2tib3g6bm90KDpjaGVja2VkKScpLmxlbmd0aCk7XHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBmdW5jdGlvbiBhcHBlbmRMaXN0KHRvZG9JdGVtKSB7XHJcbiAgICAgICAgbGV0IHByaW9yaXR5Q2xhc3MgPSB0b1ByaW9yaXR5Q2xhc3ModG9kb0l0ZW0ucHJpb3JpdHkpOyAgICAgXHJcbiAgICAgICAgJHRvZG9saXN0LmFwcGVuZChgXHJcbiAgICAgICAgICAgIDxsaSBjbGFzcz1cImpzLXRvZG9pdGVtICR7cHJpb3JpdHlDbGFzc31cIj5cclxuICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJ0b2RvaXRlbS0ke3RvZG9JdGVtLmlkfVwiIHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwianMtY2hlY2tib3hcIiB2YWx1ZT1cIiR7dG9kb0l0ZW0uaWR9XCI+XHJcbiAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cInRvZG9pdGVtLSR7dG9kb0l0ZW0uaWR9XCI+XHJcbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiZGV0YWlsLmh0bWw/aWQ9JHt0b2RvSXRlbS5pZH1cIiB0aXRsZT1cIiR7dG9kb0l0ZW0uZGV0YWlsfVwiPiR7dG9kb0l0ZW0udGl0bGV9PC9hPlxyXG4gICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICBgKTtcclxuXHJcbiAgICAgIH1cclxuIFxyXG4gICAgICBmdW5jdGlvbiB0b1ByaW9yaXR5Q2xhc3MocHJpb3JpdHkpIHtcclxuICAgICAgICBsZXQgcHJpb3JpdHlDbGFzcztcclxuICAgICAgICAgc3dpdGNoIChwcmlvcml0eSkge1xyXG4gICAgICAgICAgY2FzZSAnMCc6XHJcbiAgICAgICAgICAgIHByaW9yaXR5Q2xhc3MgPSAncHJpb3JpdHktaGlnaCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAnMSc6XHJcbiAgICAgICAgICAgIHByaW9yaXR5Q2xhc3MgPSAncHJpb3JpdHktbWVkJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICcyJzpcclxuICAgICAgICAgICAgcHJpb3JpdHlDbGFzcyA9ICdwcmlvcml0eS1sb3cnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByaW9yaXR5Q2xhc3M7ICAgICBcclxuICAgICAgfVxyXG4gIH0pO1xyXG59KSgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=